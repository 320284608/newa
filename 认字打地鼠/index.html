<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä½³æ’ğŸ“è®¤å­—æ‰“åœ°é¼ æ¸¸æˆğŸ”¨</title>
  <script src="https://cdn.tailwindcss.com/3.4.16"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <script>
    // Firebaseé…ç½®
    const firebaseConfig = {
      apiKey: "AIzaSyA4B1hpFsq2E-CZD6m1iphhzRjByv-1bcI",
      authDomain: "literacy-whack-a-mole-e9486.firebaseapp.com",
      databaseURL: "https://literacy-whack-a-mole-e9486-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "literacy-whack-a-mole-e9486",
      storageBucket: "literacy-whack-a-mole-e9486.firebasestorage.app",
      messagingSenderId: "7840821292",
      appId: "1:7840821292:web:cfd6cf2d4e3ae90e0ee189"
    };
    
    // åˆå§‹åŒ–Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#FF6B6B',
            secondary: '#4ECDC4'
          },
          borderRadius: {
            'none': '0px',
            'sm': '4px',
            DEFAULT: '8px',
            'md': '12px',
            'lg': '16px',
            'xl': '20px',
            '2xl': '24px',
            '3xl': '32px',
            'full': '9999px',
            'button': '8px'
          }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
  <style>
    :where([class^="ri-"])::before {
      content: "\f3c2";
    }

    body {
      font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
      height: 762px;
      width: 375px;
      margin: 0 auto;
      position: relative;
      overflow: hidden;
    }

    .mole {
      transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      transform: translateY(100%);
      visibility: hidden;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-end;
      padding-bottom: 10px;
    }

    .mole.active {
      transform: translateY(40%);
      visibility: visible;
    }

    .word-bubble {
      background: white;
      border-radius: 12px;
      padding: 4px 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      font-size: 0.875rem;
      line-height: 1.25rem;
      margin-bottom: 4px;
      white-space: nowrap;
      z-index: 1;
    }

    .hole {
      position: relative;
      overflow: hidden;
      border-radius: 50%;
      background: radial-gradient(circle at center 70%, #5a3921, #3a2410);
      box-shadow: inset 0 5px 10px rgba(0, 0, 0, 0.5);
    }

    .score-animation {
      position: absolute;
      animation: float-up 1s forwards;
      pointer-events: none;
    }

    @keyframes float-up {
      0% {
        opacity: 1;
        transform: translateY(0);
      }

      100% {
        opacity: 0;
        transform: translateY(-50px);
      }
    }

    .particles {
      position: absolute;
      pointer-events: none;
    }

    .particle {
      position: absolute;
      border-radius: 50%;
      animation: particle-animation 0.8s forwards;
    }

    @keyframes particle-animation {
      0% {
        opacity: 1;
        transform: translate(0, 0) scale(1);
      }

      100% {
        opacity: 0;
        transform: translate(var(--tx), var(--ty)) scale(0);
      }
    }

    .modal-backdrop {
      backdrop-filter: blur(5px);
    }

    .word-bubble {
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      border-radius: 12px;
      padding: 4px 12px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      min-width: max-content;
      z-index: 2;
    }

    .word-bubble:after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      border-left: 8px solid transparent;
      border-right: 8px solid transparent;
      border-top: 8px solid white;
    }

    .theme-btn.selected {
      box-shadow: 0 0 0 2px currentColor;
    }

    .mole {
      background-color: transparent !important;
    }

    .mole div[class^="text-"] {
      color: var(--mole-color);
    }

    .push-section {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    #send-push {
      transition: all 0.3s ease;
    }

    #send-push:hover {
      transform: scale(1.02);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    #send-push:active {
      transform: scale(0.98);
    }

    #start-screen {
      z-index: 50;
    }

    #settings-panel {
      z-index: 60;
    }

    #target-word-container.hidden-word #target-word {
      opacity: 0;
      pointer-events: none;
    }

    #target-word-container.hidden-word::after {
      content: "ç‚¹å‡»å¬å‘éŸ³";
      display: block;
      font-size: 0.75rem;
      color: #666;
    }
    
    /* æ–‡å­—æ ·å¼ */
    #target-word {
        font-size: 1.8rem;
        font-weight: 600;
        color: #2d3748;
        letter-spacing: 2px;
    }

    .word-bubble {
        font-size: 1.2rem;
        padding: 8px 12px;
        min-width: 3em;
        line-height: 1.5;
        font-weight: 500;
    }

    .word-bubble:after {
        border-left: 10px solid transparent;
        border-right: 10px solid transparent;
        border-top: 10px solid white;
        bottom: -10px;
    }

    #timer, #score {
        font-size: 1.8rem;
        min-width: 2em;
        text-align: center;
    }

    #difficulty-indicator {
        font-size: 1.1rem;
        padding: 6px 16px;
    }

    /* ç»“ç®—ç•Œé¢ */
    #final-score {
        font-size: 3.5rem;
        margin: 10px 0;
    }
    
    /* è®¾ç½®é¢æ¿ */
    #settings-panel .text-lg {
        font-size: 1.3rem;
    }
    
    .difficulty-btn, .speed-btn {
        font-size: 1rem;
        padding: 8px 16px;
    }

    /* å¼€å§‹ç•Œé¢ */
    .font-['Pacifico'] {
        font-size: 3rem;
        margin-bottom: 1.5rem;
    }
    
    #start-screen h1 {
        font-size: 2.2rem;
        margin-bottom: 2rem;
    }

    /* æŒ‰é’®æ ·å¼ */
    #play-again, #back-home, #send-push,
    #start-game, #open-settings {
        font-size: 1.1rem;
        padding: 12px 20px;
    }

    /* æ’è¡Œæ¦œæ ·å¼ */
    #leaderboard-panel {
      z-index: 70;
    }
    
    #leaderboard-list {
      max-height: 50vh;
      overflow-y: auto;
    }
    
    .leaderboard-item {
      transition: all 0.2s;
    }
    
    .leaderboard-item:hover {
      transform: scale(1.02);
    }
    
    /* è¾“å…¥æ¡†æ ·å¼ */
    #player-name {
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 10px 12px;
      font-size: 1rem;
      outline: none;
      transition: all 0.3s;
    }
    
    #player-name:focus {
      border-color: #4ECDC4;
      box-shadow: 0 0 0 2px rgba(78, 205, 196, 0.2);
    }
    /* åœ¨ç°æœ‰æ ·å¼ä¸­æ·»åŠ  */
.leaderboard-item {
  transition: transform 0.2s, box-shadow 0.2s;
  border: 1px solid #e2e8f0;
}

.leaderboard-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.text-amber-700 { color: #b45309; }
  </style>
</head>

<body class="bg-gray-50 relative">
  <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
  <div class="fixed top-0 w-full theme-nav shadow-md z-50 px-4 py-2 flex items-center justify-between">
    <div class="flex items-center">
      <div class="w-10 h-10 flex items-center justify-center bg-primary rounded-full text-white mr-2">
        <i class="ri-time-line ri-lg"></i>
      </div>
      <div id="timer" class="text-xl font-bold">
        60
      </div>
    </div>
    <div id="target-word-container" class="flex flex-col items-center relative hidden-word">
      <div id="target-word">å­¦</div>
    </div>
    <div class="flex items-center">
      <div class="w-10 h-10 flex items-center justify-center bg-primary rounded-full text-white mr-2">
        <i class="ri-medal-line ri-lg"></i>
      </div>
      <div id="score" class="text-xl font-bold">
        0
      </div>
    </div>
  </div>

  <!-- éš¾åº¦æŒ‡ç¤ºå™¨ -->
  <div class="fixed top-16 w-full flex justify-center z-40 mt-2">
    <div class="bg-white rounded-full px-4 py-1 shadow-md">
      <span id="difficulty-indicator" class="text-sm font-medium">åˆçº§</span>
    </div>
  </div>

  <!-- ä¸»æ¸¸æˆåŒºåŸŸ -->
  <div class="pt-28 pb-20 px-4">
    <div id="game-container" class="grid grid-cols-3 gap-3">
      <!-- æ´ç©´å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
    </div>
  </div>

  <!-- åº•éƒ¨æ§åˆ¶æ  -->
  <div class="fixed bottom-0 w-full theme-nav shadow-lg z-50 px-4 py-3 flex justify-around">
    <button id="restart-btn" class="w-12 h-12 flex items-center justify-center bg-primary text-white rounded-full shadow-md cursor-pointer">
      <i class="ri-restart-line ri-lg"></i>
    </button>
    <button id="home-btn" class="w-12 h-12 flex items-center justify-center bg-primary text-white rounded-full shadow-md cursor-pointer">
      <i class="ri-home-line ri-lg"></i>
    </button>
    <button id="settings-btn" class="w-12 h-12 flex items-center justify-center bg-primary text-white rounded-full shadow-md cursor-pointer">
      <i class="ri-settings-line ri-lg"></i>
    </button>
    <button id="speed-btn" class="w-12 h-12 flex items-center justify-center bg-primary text-white rounded-full shadow-md cursor-pointer">
      <i class="ri-speed-line ri-lg"></i>
    </button>
  </div>

  <!-- è®¾ç½®é¢æ¿ -->
  <div id="settings-panel" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-white rounded-lg w-4/5 p-5">
      <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-bold">è®¾ç½®</h3>
      <button id="close-settings" class="w-8 h-8 flex items-center justify-center cursor-pointer">
        <i class="ri-close-line ri-lg"></i>
      </button>
    </div>
    <!-- åœ¨åŸæœ‰è®¾ç½®é¡¹åæ·»åŠ  -->
    <div class="mt-6 border-t pt-4">
      <p class="mb-2 font-medium">å…¶ä»–åŠŸèƒ½</p>
      <button id="view-leaderboard-settings" 
              class="w-full bg-purple-500 text-white py-2 rounded-lg font-medium cursor-pointer flex items-center justify-center">
        <i class="ri-bar-chart-line mr-2"></i>æŸ¥çœ‹æ’è¡Œæ¦œ
      </button>
    </div>
      <div class="mb-4">
        <p class="mb-2 font-medium">æ˜¾ç¤ºè®¾ç½®</p>
        <div class="flex items-center space-x-2">
          <button id="toggle-word" class="flex items-center px-3 py-1 bg-white border border-gray-300 rounded-full cursor-pointer">
            <i class="ri-eye-off-line mr-1"></i>
            <span>éšè—ç›®æ ‡æ–‡å­—</span>
          </button>
        </div>
        <p class="mb-2 font-medium">ä¸»é¢˜</p>
        <div class="flex space-x-2">
          <button class="theme-btn px-3 py-1 border rounded-full cursor-pointer transition-all" data-theme="light" style="background-color: #f8fafc; color: #1a1a1a">
            é»˜è®¤
          </button>
          <button class="theme-btn px-3 py-1 border rounded-full cursor-pointer transition-all" data-theme="dark" style="background-color: #1f2937; color: #f3f4f6">
            å¤œé—´
          </button>
          <button class="theme-btn px-3 py-1 border rounded-full cursor-pointer transition-all" data-theme="eye" style="background-color: #DCE6C6; color: #3E5915">
            æŠ¤çœ¼
          </button>
          <button class="theme-btn px-3 py-1 border rounded-full cursor-pointer transition-all" data-theme="colorful" style="background: linear-gradient(135deg, #f3e8ff, #ffe4e6, #fff1e6); color: #1a1a1a">
            å¤šå½©
          </button>
        </div>
      </div>
      <div class="mb-4">
        <p class="mb-2 font-medium">éš¾åº¦</p>
        <div class="flex flex-wrap gap-2">
          <button class="difficulty-btn px-3 py-1 bg-white border border-gray-300 rounded-full !rounded-button cursor-pointer" data-level="1">åˆçº§</button>
          <button class="difficulty-btn px-3 py-1 bg-white border border-gray-300 rounded-full !rounded-button cursor-pointer" data-level="2">ä¸­çº§</button>
          <button class="difficulty-btn px-3 py-1 bg-white border border-gray-300 rounded-full !rounded-button cursor-pointer" data-level="3">é«˜çº§</button>
          <button class="difficulty-btn px-3 py-1 bg-white border border-gray-300 rounded-full !rounded-button cursor-pointer" data-level="4">è¿›é˜¶</button>
          <button class="difficulty-btn px-3 py-1 bg-white border border-gray-300 rounded-full !rounded-button cursor-pointer" data-level="5">ç»ˆæ</button>
        </div>
      </div>
      <div>
        <p class="mb-2 font-medium">é€Ÿåº¦</p>
        <div class="flex space-x-2">
          <button class="speed-btn px-3 py-1 bg-white border border-gray-300 rounded-full !rounded-button cursor-pointer" data-speed="slow">æ…¢é€Ÿ</button>
          <button class="speed-btn px-3 py-1 bg-white border border-gray-300 rounded-full !rounded-button cursor-pointer" data-speed="medium">ä¸­é€Ÿ</button>
          <button class="speed-btn px-3 py-1 bg-white border border-gray-300 rounded-full !rounded-button cursor-pointer" data-speed="fast">å¿«é€Ÿ</button>
        </div>
      </div>
    </div>
  </div>

  <!-- é€Ÿåº¦è°ƒèŠ‚é¢æ¿ -->
  <div id="speed-panel" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-white rounded-lg w-4/5 p-5">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-bold">é€Ÿåº¦è°ƒèŠ‚</h3>
        <button id="close-speed" class="w-8 h-8 flex items-center justify-center cursor-pointer">
          <i class="ri-close-line ri-lg"></i>
        </button>
      </div>
      <div class="flex flex-col space-y-4">
        <button class="speed-select px-4 py-2 bg-white border border-gray-300 rounded-lg !rounded-button flex items-center justify-between cursor-pointer" data-speed="slow">
          <span>æ…¢é€Ÿ</span>
          <i class="ri-check-line ri-lg text-primary hidden"></i>
        </button>
        <button class="speed-select px-4 py-2 bg-white border border-gray-300 rounded-lg !rounded-button flex items-center justify-between cursor-pointer" data-speed="medium">
          <span>ä¸­é€Ÿ</span>
          <i class="ri-check-line ri-lg text-primary"></i>
        </button>
        <button class="speed-select px-4 py-2 bg-white border border-gray-300 rounded-lg !rounded-button flex items-center justify-between cursor-pointer" data-speed="fast">
          <span>å¿«é€Ÿ</span>
          <i class="ri-check-line ri-lg text-primary hidden"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- ç»“ç®—ç•Œé¢ -->
  <div id="result-panel" class="fixed inset-0 bg-black bg-opacity-50 modal-backdrop z-50 hidden flex items-center justify-center">
    <div class="bg-white rounded-lg w-4/5 p-5">
      <div class="text-center mb-6">
        <h2 class="text-2xl font-bold mb-2">æ¸¸æˆç»“æŸ</h2>
        <div class="text-4xl font-bold text-primary mb-2" id="final-score">
          0
        </div>
        <div class="text-sm text-gray-500">
          ä½ çš„å¾—åˆ†
        </div>
      </div>
      <div class="space-y-3 mb-6">
        <div class="flex justify-between">
          <span class="text-gray-600">ç”¨æ—¶</span>
          <span id="result-time" class="font-medium">60ç§’</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">æ­£ç¡®ç‡</span>
          <span id="result-accuracy" class="font-medium">0%</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">éš¾åº¦</span>
          <span id="result-difficulty" class="font-medium">åˆçº§</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">æœ€é«˜è¿å‡»</span>
          <span id="result-combo" class="font-medium">0</span>
        </div>
      </div>
      <div class="flex space-x-3">
        <button id="play-again" class="flex-1 bg-primary text-white py-2 rounded-lg !rounded-button font-medium cursor-pointer">å†ç©ä¸€æ¬¡</button>
        <button id="back-home" class="flex-1 bg-gray-100 py-2 rounded-lg !rounded-button font-medium cursor-pointer">è¿”å›é¦–é¡µ</button>
      </div>
      <div class="push-section mt-4">
        <div class="text-sm text-gray-600 mb-2" id="push-message"></div>
        <input type="text" id="player-name" class="w-full mb-2 p-2 border rounded-lg" placeholder="è¾“å…¥ä½ çš„åå­—" maxlength="10">
        <button id="submit-score" class="w-full bg-blue-500 text-white py-2 rounded-lg font-medium cursor-pointer">
          <i class="ri-trophy-line mr-2"></i>æäº¤åˆ°æ’è¡Œæ¦œ
        </button>
        <button id="view-leaderboard" class="w-full mt-2 bg-purple-500 text-white py-2 rounded-lg font-medium cursor-pointer">
          <i class="ri-bar-chart-line mr-2"></i>æŸ¥çœ‹æ’è¡Œæ¦œ
        </button>
        <button id="send-push" class="w-full mt-2 bg-green-500 text-white py-2 rounded-lg font-medium cursor-pointer">
          <i class="ri-send-plane-line mr-2"></i>å‘é€æˆç»©ç»™å®¶é•¿
        </button>
      </div>
    </div>
  </div>

  <!-- æ’è¡Œæ¦œé¢æ¿ -->
  <div id="leaderboard-panel" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-white rounded-lg w-4/5 p-5 max-h-[70vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-bold">æ’è¡Œæ¦œ</h3>
        <button id="close-leaderboard" class="w-8 h-8 flex items-center justify-center cursor-pointer">
          <i class="ri-close-line ri-lg"></i>
        </button>
      </div>
      <div id="leaderboard-list" class="space-y-2">
        <!-- æ’è¡Œæ¦œå†…å®¹åŠ¨æ€åŠ è½½ -->
      </div>
    </div>
  </div>

  <!-- å¼€å§‹ç•Œé¢ -->
  <div id="start-screen" class="fixed inset-0 bg-white z-50 flex flex-col items-center justify-center">
    <div class="font-['Pacifico'] text-4xl text-primary mb-4">
      æ›¦æ°´æ’æµ
    </div>
    <h1 class="text-2xl font-bold mb-6">è®¤å­—æ‰“åœ°é¼ </h1>
    <div class="w-64 h-64 mb-8 relative">
      <img src="1.img" alt="åœ°é¼ å½¢è±¡" class="w-full h-full object-contain">
    </div>
    <div class="w-64 mb-4">
      <p class="text-sm font-medium mb-2">é€‰æ‹©éš¾åº¦</p>
      <div class="grid grid-cols-2 gap-2">
        <button class="start-difficulty px-2 py-1 bg-gray-100 rounded-lg" data-level="1">åˆçº§</button>
        <button class="start-difficulty px-2 py-1 bg-gray-100 rounded-lg" data-level="2">ä¸­çº§</button>
        <button class="start-difficulty px-2 py-1 bg-gray-100 rounded-lg" data-level="3">é«˜çº§</button>
        <button class="start-difficulty px-2 py-1 bg-gray-100 rounded-lg" data-level="4">è¿›é˜¶</button>
        <button class="start-difficulty px-2 py-1 bg-gray-100 rounded-lg" data-level="5">ç»ˆæ</button>
      </div>
    </div>
    <div class="space-y-4 w-64">
      <button id="start-game" class="w-full bg-primary text-white py-3 rounded-lg !rounded-button font-medium text-lg cursor-pointer shadow-md">å¼€å§‹æ¸¸æˆ</button>
      <button id="open-settings" class="w-full bg-gray-100 py-3 rounded-lg !rounded-button font-medium text-lg cursor-pointer">æ¸¸æˆè®¾ç½®</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // æ¸¸æˆæ•°æ®
      const gameData = {
        level1: ["å­¦", "ä¹ ", "å¥½", "äºº", "å¤§", "å°", "ä¸Š", "ä¸‹", "ä¸­", "å›½", "å¤©", "åœ°", "æ—¥", "æœˆ", "æ°´", "ç«", "å±±", "æœ¨", "å£", "æ‰‹", "å¿ƒ", "ç›®", "è€³", "é¼»", "å®¶", "ä¹¦", "è½¦", "é—¨", "é±¼", "é¸Ÿ", "è™«", "é©¬", "ç‰›", "ç¾Š", "çŒ«", "ç‹—", "å…”", "é¾™", "èŠ±", "è‰", "æ ‘", "ç±³", "é¢", "èœ", "æœ", "èŒ¶", "æ°´", "é£", "é›¨", "é›ª", "äº‘", "ç”µ", "è·¯", "æ¡¥", "æµ·", "æ²³", "æ¹–", "æ±Ÿ", "åŸ", "çˆ¸", "å¦ˆ", "çˆ·", "å¥¶", "å“¥", "å§", "å¼Ÿ", "å¦¹", "æ¡Œ", "æ¤…", "åºŠ", "è¢«", "æ•", "ç¯", "ç¬”", "çº¸", "æœ¬", "åˆ€", "å°º", "çƒ", "æ‹", "ç»³", "é’Ÿ", "è¡¨", "ä¼", "å¸½", "è¡£", "è£¤", "é‹", "è¢œ", "é”…", "ç¢—", "ç­·", "å‹º", "å‰", "ç“¶", "æ¯", "ç›˜", "ç›†", "æ¡¶", "è¢‹", "åŒ…", "ç®±", "é”", "é’¥", "é’‰", "é”¤", "æ–§", "é”¯", "é”„", "é•°", "æ¢¯", "å‡³", "æ¢¯", "æ‰‡", "é•œ", "æ¢³", "åˆ·", "çš‚", "é¦™", "æ²¹", "ç›", "ç³–", "é…±", "é†‹", "å¥¶", "è›‹", "è±†", "ç“œ", "èŒ„", "æ¤’", "è‘±", "å§œ", "è’œ", "è¯", "é’ˆ", "çº¿", "å¸ƒ", "æ¯›", "çš®", "çŸ³", "æ²™", "åœŸ", "æ³¥", "ç°", "çƒŸ", "é›¾", "å†°", "éœœ", "æ˜Ÿ", "è¾°", "å…‰", "æ˜", "æš—", "é»‘", "ç™½", "çº¢", "ç»¿", "é»„", "è“", "ç´«", "æ©™", "ç²‰", "æ£•", "ç°", "é‡‘", "é“¶", "æ¡Œ", "æ¤…", "åºŠ", "æŸœ", "çª—", "å¸˜", "é’Ÿ", "è¡¨", "ç”»", "ä¹¦", "æ¶", "ç¬”", "å¢¨", "çº¸", "ç š", "ç´", "æ£‹", "ä¹¦", "ç”»", "èŠ±", "é¸Ÿ", "é±¼", "è™«", "å±±", "æ°´", "äº‘", "éœ", "é›·", "ç”µ", "é£", "é›¨", "é›ª", "éœœ", "å†°", "ç«", "åœŸ", "çŸ³", "é‡‘", "æœ¨", "æ°´", "ç«", "åœŸ", "æ—¥", "æœˆ", "æ˜Ÿ", "ç©º", "æµ·", "æ´‹", "æ²³", "æ±Ÿ", "æ¹–", "æºª", "è°·", "å³°", "å²­", "ä¸˜", "åŸ", "å·", "ç”°", "å›­", "æ—", "æ£®", "æœ", "è”¬", "ç²®", "è°·", "è±†", "ç±³", "é¢", "æ²¹", "ç›", "ç³–", "é…±", "é†‹", "èŒ¶", "é…’", "å¥¶", "è›‹", "è‚‰", "é±¼", "è™¾", "èŸ¹", "è´", "è‡", "èŒ", "è¯", "æ", "èŠ±", "è‰", "æ ‘", "æœ¨", "æ ¹", "èŒ", "å¶", "æ", "èŠ½", "è•¾", "ç±½", "çš®", "æ¯›", "ç¾½", "è§’", "ç‰™", "éª¨", "è¡€", "è‚‰", "å¿ƒ", "è‚", "è„¾", "è‚º", "è‚¾", "è‚ ", "èƒƒ", "è„‘", "çœ¼", "è€³", "é¼»", "å˜´", "èˆŒ", "ç‰™", "å”‡", "æ‰‹", "è¶³", "è…¿", "è‡‚", "è‚©", "èƒŒ", "è…°", "è‚š", "è†", "è‚˜", "è…•", "æŒ‡", "è¶¾", "å‘", "é¡»", "çœ‰", "æ±—", "æ³ª", "æ¶•", "å±", "å°¿", "å±", "å£°", "éŸ³", "æ­Œ", "èˆ", "è¯—", "è¯", "ä¹¦", "æ–‡", "å­—", "æ•°", "ç†", "åŒ–", "ç”Ÿ", "åœ°", "å†", "æ”¿", "ç¾", "ä½“", "åŠ³", "ç§‘", "æŠ€", "ç½‘", "ç”µ", "æœº", "è½¦", "èˆ¹", "é£", "ç‚®", "æª", "å¼¹", "è¯", "å…µ", "å°†", "å¸…", "å›½", "å®¶", "æ°‘", "æ—", "å…š", "ç¤¾", "ä¼š", "æ³•", "å¾‹", "è§„", "åˆ™", "å…¬", "å¹³", "æ­£", "ä¹‰", "é“", "å¾·", "ç¤¼", "ä»ª", "å»‰", "è€»", "è£", "è¾±", "å¯Œ", "è´«", "è´µ", "è´±", "ç¦", "ç¥¸", "å‰", "å‡¶", "å–œ", "æ€’", "å“€", "ä¹"],
        level2: ["å­¦ä¹ ", "å·¥ä½œ", "ç”Ÿæ´»", "æœ‹å‹", "å®¶äºº", "è€å¸ˆ", "å­¦ç”Ÿ", "åŒ»ç”Ÿ", "è­¦å¯Ÿ", "å¸æœº", "å•†åº—", "å…¬å›­", "å­¦æ ¡", "åŒ»é™¢", "é“¶è¡Œ", "é¤å…", "ç”µå½±", "éŸ³ä¹", "è¿åŠ¨", "æ¸¸æˆ", "ç”µè„‘", "æ‰‹æœº", "ç”µè§†", "æ±½è½¦", "é£æœº", "ç«è½¦", "åœ°é“", "å…¬äº¤", "æ—©é¤", "åˆé¤", "æ™šé¤", "æ°´æœ", "è”¬èœ", "è‚‰ç±»", "æµ·é²œ", "ç”œç‚¹", "é¥®æ–™", "å’–å•¡", "èŒ¶å¶", "å¤©æ°”", "å­£èŠ‚", "æ˜¥å¤©", "å¤å¤©", "ç§‹å¤©", "å†¬å¤©", "èŠ‚æ—¥", "ç”Ÿæ—¥", "æ–°å¹´", "ä¸­ç§‹", "å›½åº†"],
        level3: ["ä¸€å¸†é£é¡º", "ä¸‡äº‹å¦‚æ„", "å››é¢å…«æ–¹", "äº”å…‰åè‰²", "å…­ç¥æ— ä¸»", "ä¸ƒä¸Šå…«ä¸‹", "å…«é¢ç²ç‘", "ä¹ç‰›ä¸€æ¯›", "åå…¨åç¾", "ç™¾å‘ç™¾ä¸­", "åƒæ–¹ç™¾è®¡", "ä¸‡ç´«åƒçº¢", "ä¸‰å¿ƒäºŒæ„", "åŠä¿¡åŠç–‘", "è‡ªè¨€è‡ªè¯­", "è‡ªä½œè‡ªå—", "å¤§æ‰‹å¤§è„š", "ä¸œå¼ è¥¿æœ›", "å—è¾•åŒ—è¾™", "å·¦æ€å³æƒ³", "ä¸€é©¬å½“å…ˆ", "äºŒè¯ä¸è¯´", "ä¸‰è¨€ä¸¤è¯­", "å››é€šå…«è¾¾", "äº”èŠ±å…«é—¨", "å…­å…­å¤§é¡º", "ä¸ƒå˜´å…«èˆŒ", "å…«ä»™è¿‡æµ·", "ä¹æ­»ä¸€ç”Ÿ", "åæ‹¿ä¹ç¨³", "ç™¾ä¾ç™¾é¡º", "åƒå˜ä¸‡åŒ–", "ä¸‡æ— ä¸€å¤±", "ä¸€ç©·äºŒç™½", "ä¸€æ¸…äºŒæ¥š", "ä¸€å¹²äºŒå‡€", "ä¸€äº†ç™¾äº†", "ä¸€å‘¼ç™¾åº”", "ä¸€å”±ä¸€å’Œ", "ä¸€é¢¦ä¸€ç¬‘", "ä¸€è‰ä¸€æœ¨", "ä¸€ç‚¹ä¸€æ»´", "ä¸€ç”Ÿä¸€ä¸–", "ä¸€å¹´ä¸€åº¦", "ä¸€äº”ä¸€å", "ä¸€æ¨¡ä¸€æ ·", "ä¸€æœä¸€å¤•", "ä¸€é’ˆä¸€çº¿", "ä¸€å­—ä¸€å¥", "ä¸€æ­¥ä¸€è¶‹", "ä¸€ç˜¸ä¸€æ‹", "ä¸€çŸ¥åŠè§£", "ä¸€è½åƒä¸ˆ", "ä¸€æ›åå¯’", "ä¸€ä¸˜ä¹‹è²‰", "ä¸€è§†åŒä»", "ä¸€å¢æƒ…æ„¿", "ä¸€æ„å­¤è¡Œ", "ä¸€è¹´è€Œå°±", "ä¸€è´¥æ¶‚åœ°", "ä¸€æœ¬æ­£ç»", "ä¸€ç¬”å‹¾é”€", "ä¸€è‡‚ä¹‹åŠ›", "ä¸€å°˜ä¸æŸ“", "ä¸€æˆä¸å˜", "ä¸€ç­¹è«å±•", "ä¸€è§¦å³å‘", "ä¸€é”¤å®šéŸ³", "ä¸€è¹¶ä¸æŒ¯", "ä¸€æŠ€ä¹‹é•¿", "ä¸€å®¶ä¹‹è¨€", "ä¸€è§é’Ÿæƒ…", "ä¸€ç®­åŒé›•", "ä¸€ä¸¾æˆå", "ä¸€ä¸¾ä¸¤å¾—", "ä¸€è¹¶ä¸æŒ¯", "ä¸€è§ˆæ— ä½™", "ä¸€åŠ³æ°¸é€¸", "ä¸€é©¬å¹³å·", "ä¸€è„‰ç›¸æ‰¿", "ä¸€é¢ä¹‹è¯", "ä¸€é¸£æƒŠäºº", "ä¸€ç›®äº†ç„¶", "ä¸€è´«å¦‚æ´—", "ä¸€æ°”å‘µæˆ", "ä¸€çªä¸é€š", "ä¸€å¦‚æ—¢å¾€", "ä¸€æ‰«è€Œç©º", "ä¸€èº«æ˜¯èƒ†", "ä¸€å¡Œç³Šæ¶‚", "ä¸€é€šç™¾é€š", "ä¸€ç½‘æ‰“å°½", "ä¸€å¾€æƒ…æ·±", "ä¸€æœ›æ— é™…", "ä¸€æ–‡ä¸å€¼", "ä¸€æ— æ˜¯å¤„", "ä¸€æ— æ‰€è·", "ä¸€æ— æ‰€æœ‰", "ä¸€æ— æ‰€çŸ¥", "ä¸€æ³»åƒé‡Œ", "ä¸€è¡£å¸¦æ°´", "ä¸€æ„å­¤è¡Œ", "ä¸€è¯­é“ç ´", "ä¸€è¯­åŒå…³", "ä¸€å¼ ä¸€å¼›", "ä¸€æœå¤©å­ä¸€æœè‡£"],
        level4: ["ä¸€ä¸¾ä¸¤å¾—", "å››é¢å…«æ–¹", "äº”é¢œå…­è‰²", "ä¸ƒä¸Šå…«ä¸‹", "ä¹ç‰›ä¸€æ¯›", "åå…¨åç¾", "ç™¾å‘ç™¾ä¸­", "åƒå˜ä¸‡åŒ–", "ä¸‡ç´«åƒçº¢", "ä¸‰å¿ƒäºŒæ„", "åŠä¿¡åŠç–‘", "è‡ªè¨€è‡ªè¯­", "è‡ªä½œè‡ªå—", "å‰å› åæœ", "ä¸œå¼ è¥¿æœ›", "å—è¾•åŒ—è¾™", "å·¦æ€å³æƒ³", "æœ‰å§‹æœ‰ç»ˆ", "æ— å½±æ— è¸ª", "å¤©é•¿åœ°ä¹…", "ä¸€é©¬å½“å…ˆ", "äºŒè¯ä¸è¯´", "ä¸‰è¨€ä¸¤è¯­", "å››é€šå…«è¾¾", "äº”èŠ±å…«é—¨", "å…­å…­å¤§é¡º", "ä¸ƒå˜´å…«èˆŒ", "å…«ä»™è¿‡æµ·", "ä¹æ­»ä¸€ç”Ÿ", "åæ‹¿ä¹ç¨³", "ç™¾ä¾ç™¾é¡º", "åƒå˜ä¸‡åŒ–", "ä¸‡æ— ä¸€å¤±", "ä¸€ç©·äºŒç™½", "ä¸€æ¸…äºŒæ¥š", "ä¸€å¹²äºŒå‡€", "ä¸€äº†ç™¾äº†", "ä¸€å‘¼ç™¾åº”", "ä¸€å”±ä¸€å’Œ", "ä¸€é¢¦ä¸€ç¬‘", "ä¸€è‰ä¸€æœ¨", "ä¸€ç‚¹ä¸€æ»´", "ä¸€ç”Ÿä¸€ä¸–", "ä¸€å¹´ä¸€åº¦", "ä¸€äº”ä¸€å", "ä¸€æ¨¡ä¸€æ ·", "ä¸€æœä¸€å¤•", "ä¸€é’ˆä¸€çº¿", "ä¸€å­—ä¸€å¥", "ä¸€æ­¥ä¸€è¶‹", "ä¸€ç˜¸ä¸€æ‹", "ä¸€çŸ¥åŠè§£", "ä¸€è½åƒä¸ˆ", "ä¸€æ›åå¯’", "ä¸€ä¸˜ä¹‹è²‰", "ä¸€è§†åŒä»", "ä¸€å¢æƒ…æ„¿", "ä¸€æ„å­¤è¡Œ", "ä¸€è¹´è€Œå°±", "ä¸€è´¥æ¶‚åœ°", "ä¸€æœ¬æ­£ç»", "ä¸€ç¬”å‹¾é”€", "ä¸€è‡‚ä¹‹åŠ›", "ä¸€å°˜ä¸æŸ“", "ä¸€æˆä¸å˜", "ä¸€ç­¹è«å±•", "ä¸€è§¦å³å‘", "ä¸€é”¤å®šéŸ³", "ä¸€è¹¶ä¸æŒ¯", "ä¸€æŠ€ä¹‹é•¿", "ä¸€å®¶ä¹‹è¨€", "ä¸€è§é’Ÿæƒ…", "ä¸€ç®­åŒé›•", "ä¸€ä¸¾æˆå", "ä¸€ä¸¾ä¸¤å¾—", "ä¸€è¹¶ä¸æŒ¯", "ä¸€è§ˆæ— ä½™", "ä¸€åŠ³æ°¸é€¸", "ä¸€é©¬å¹³å·", "ä¸€è„‰ç›¸æ‰¿", "ä¸€é¢ä¹‹è¯", "ä¸€é¸£æƒŠäºº", "ä¸€ç›®äº†ç„¶", "ä¸€è´«å¦‚æ´—", "ä¸€æ°”å‘µæˆ", "ä¸€çªä¸é€š", "ä¸€å¦‚æ—¢å¾€", "ä¸€æ‰«è€Œç©º", "ä¸€èº«æ˜¯èƒ†", "ä¸€å¡Œç³Šæ¶‚", "ä¸€é€šç™¾é€š", "ä¸€ç½‘æ‰“å°½", "ä¸€å¾€æƒ…æ·±", "ä¸€æœ›æ— é™…", "ä¸€æ–‡ä¸å€¼", "ä¸€æ— æ˜¯å¤„", "ä¸€æ— æ‰€è·", "ä¸€æ— æ‰€æœ‰", "ä¸€æ— æ‰€çŸ¥", "ä¸€æ³»åƒé‡Œ", "ä¸€è¡£å¸¦æ°´", "ä¸€æ„å­¤è¡Œ", "ä¸€è¯­é“ç ´", "ä¸€è¯­åŒå…³", "ä¸€å¼ ä¸€å¼›", "ä¸€æœå¤©å­ä¸€æœè‡£", "èµ°é©¬è§‚èŠ±", "æœ›æ¢…æ­¢æ¸´", "æ©è€³ç›—é“ƒ", "å®ˆæ ªå¾…å…”", "åˆ»èˆŸæ±‚å‰‘", "å¶å…¬å¥½é¾™", "ç”»è›‡æ·»è¶³", "ç”»é¾™ç‚¹ç›", "æ»¥ç«½å……æ•°", "è‡ªç›¸çŸ›ç›¾", "äº¡ç¾Šè¡¥ç‰¢", "åäº•è§‚å¤©", "ç‹å‡è™å¨", "é»”é©´æŠ€ç©·", "ä¹°æ¤Ÿè¿˜ç ", "é‚¯éƒ¸å­¦æ­¥", "ä¸œæ–½æ•ˆé¢¦", "è³è‡‚å½“è½¦", "èšèœ‰æ’¼æ ‘", "é£è›¾æ‰‘ç«", "é‡‘è‰è„±å£³", "èœ»èœ“ç‚¹æ°´", "è››ä¸é©¬è¿¹", "è³è‚æ•è‰é»„é›€åœ¨å", "é¹¬èšŒç›¸äº‰æ¸”ç¿å¾—åˆ©", "å¡ç¿å¤±é©¬ç„‰çŸ¥éç¦", "åŸé—¨å¤±ç«æ®ƒåŠæ± é±¼", "è¿‘æ°´æ¥¼å°å…ˆå¾—æœˆ", "æ ‘æ¬²é™è€Œé£ä¸æ­¢", "å­æ¬²å…»è€Œäº²ä¸å¾…", "å°ä¸å¿åˆ™ä¹±å¤§è°‹", "å‹¿ä»¥æ¶å°è€Œä¸ºä¹‹å‹¿ä»¥å–„å°è€Œä¸ä¸º", "è¿‘æœ±è€…èµ¤è¿‘å¢¨è€…é»‘", "å‡ºæ·¤æ³¥è€Œä¸æŸ“", "æ¿¯æ¸…æ¶Ÿè€Œä¸å¦–", "å¾—é“å¤šåŠ©å¤±é“å¯¡åŠ©", "å¤©æ—¶ä¸å¦‚åœ°åˆ©åœ°åˆ©ä¸å¦‚äººå’Œ", "å±…å®‰æ€å±", "æœªé›¨ç»¸ç¼ª", "é˜²æ‚£æœªç„¶", "ä¸´æ¸Šç¾¡é±¼ä¸å¦‚é€€è€Œç»“ç½‘", "çº¸ä¸Šè°ˆå…µ", "æœ›æ´‹å…´å¹", "é«˜ç»è¿œç©", "é«˜å±‹å»ºç“´", "é«˜æœ‹æ»¡åº§", "é«˜æ•æ— å¿§", "é«˜è°ˆé˜”è®º", "é«˜é£äº®èŠ‚", "é«˜å±±ä»°æ­¢", "é«˜å±±æµæ°´", "é«˜æŠ¬è´µæ‰‹", "é«˜ä¸å¯æ”€", "é«˜ä¸æˆä½ä¸å°±", "å…´é«˜é‡‡çƒˆ", "è¶¾é«˜æ°”æ‰¬", "çœ‰é£è‰²èˆ", "çœ‰å¼€çœ¼ç¬‘", "çœ‰æ¥çœ¼å»", "çœ‰æ¸…ç›®ç§€", "çœ‰é£è‰²èˆ", "æ‰¬çœ‰åæ°”", "è¿«åœ¨çœ‰ç«", "ç‡ƒçœ‰ä¹‹æ€¥", "æ„çœ‰è‹¦è„¸", "æ„çœ‰ä¸å±•", "æ…ˆçœ‰å–„ç›®", "è´¼çœ‰é¼ çœ¼", "æŒ¤çœ‰å¼„çœ¼", "ä½çœ‰é¡ºçœ¼", "æ¨ªçœ‰å†·å¯¹", "ä¸¾æ¡ˆé½çœ‰", "ç™¾åªšåƒå¨‡", "åƒå¨‡ç™¾åªš", "å©€å¨œå¤šå§¿", "äº­äº­ç‰ç«‹", "å‡ºæ°´èŠ™è“‰", "å†°è‚Œç‰éª¨", "å†°æ¸…ç‰æ´", "é—­æœˆç¾èŠ±", "æ²‰é±¼è½é›", "å›½è‰²å¤©é¦™", "å€¾å›½å€¾åŸ", "èŠ±å®¹æœˆè²Œ", "å¦‚èŠ±ä¼¼ç‰", "ç¾è‹¥å¤©ä»™", "å¤©ç”Ÿä¸½è´¨", "ç§€è‰²å¯é¤", "å°å®¶ç¢§ç‰", "å¤§å®¶é—ºç§€", "è±†è”»å¹´å", "åŠç¬„ä¹‹å¹´", "ç ´ç“œä¹‹å¹´", "æ¡ƒæå¹´å", "èŠ±ä¿¡å¹´å", "æ‘½æ¢…ä¹‹å¹´", "åŠè€å¾å¨˜", "é£éŸµçŠ¹å­˜", "å¾å¨˜åŠè€", "äººè€ç é»„", "è€æ€é¾™é’Ÿ", "é¹¤å‘ç«¥é¢œ", "ç™½å‘è‹è‹", "é¢é»„è‚Œç˜¦", "é¢å¦‚åœŸè‰²", "é¢çº¢è€³èµ¤", "é¢é¢ç›¸è§‘", "é¢ç›®å…¨é", "é¢ç›®å¯æ†", "æ»¡é¢æ˜¥é£", "æ»¡é¢çº¢å…‰", "æ„çœ‰è‹¦è„¸", "å¬‰çš®ç¬‘è„¸", "å¬‰çš®ç¬‘è„¸", "å˜»çš®ç¬‘è„¸", "çš®ç¬‘è‚‰ä¸ç¬‘"],
        level5: ["é¾˜", "é¬»", "é‘«", "éº¤", "é½‰", "é¸¯", "é¬£", "é±»", "é¬Ÿ", "é¸¾", "é¥•", "é¤®", "æ›±", "ç”´", "å›¹", "åœ„", "é­‘", "é­…", "é­", "é­‰", "è€„", "è€‹", "é¥•", "é¤®", "å›«", "å›µ", "å­‘", "å­“", "é€¡", "å·¡", "æ—®", "æ—¯", "å½³", "äº", "æ°", "æ¯¹", "æ°™", "æ°š", "æ°¡", "æ°ª", "æ°–", "æ°©", "æ°¤", "æ°²", "ç”™", "è‚¼", "è‚Ÿ", "ç”¾", "ç ¼", "ç¾Ÿ", "ç¾§", "å·¯", "ç ¼", "ç“©", "å…›", "å…", "å…", "å…¡", "å—§", "ç“§", "ç“°", "ç”…", "ç”‚", "ç”", "ç”‰", "ç”ˆ", "ç”Š", "ç”‹", "ç”", "ç”", "ç”‘", "ç”’", "ç”“", "ç””", "ç”—", "é¬¶", "é¬²", "ç”—", "åŒ½", "åŒœ", "åŒ", "åŒ›", "åŒ", "åŒŸ", "åŒ¢", "åŒ¤", "åŒ¥", "åŒ¦", "åŒ¼", "åŒ½", "åŒ¨", "åŒ©", "åŒ«", "åŒ¬", "åŒ­", "åŒ¯", "åŒ°", "åŒ±", "åŒ²", "åŒ³", "åŒ´", "åŒµ", "åŒ¶", "åŒ·", "åŒ¸", "åŒ¹", "åŒ¼", "åŒ", "åŒ½", "åŒ¯", "åŒ®", "åŒµ", "åŒ¶", "åŒ·", "åŒ¸", "åŒ¹", "åŒ¼", "åŒ"]
      };

      // æ¸¸æˆçŠ¶æ€
      let gameState = {
        isPlaying: false,
        score: 0,
        timer: 60,
        targetWord: "",
        correctHits: 0,
        totalHits: 0,
        combo: 0,
        maxCombo: 0,
        difficulty: 1,
        speed: "medium",
        theme: "light",
        wordList: [],
        activeMoles: [],
        hasPushed: false,
        showTargetWord: false,
        audioLoop: null,
        isAudioPlaying: false,
        timerInterval: null,
        moleTimer: null,
        hasSubmittedScore: false
      };

      // é€Ÿåº¦é…ç½®ï¼ˆæ¯«ç§’ï¼‰
      const speedConfig = {
        slow: {
          min: 5000,
          max: 6000
        },
        medium: {
          min: 3000,
          max: 4000
        },
        fast: {
          min: 2000,
          max: 3000
        }
      };

      // éš¾åº¦é…ç½®
      const difficultyConfig = {
        1: {
          name: "åˆçº§",
          time: 60,
          molesPerRound: 2
        },
        2: {
          name: "ä¸­çº§",
          time: 60,
          molesPerRound: 3
        },
        3: {
          name: "é«˜çº§",
          time: 60,
          molesPerRound: 3
        },
        4: {
          name: "è¿›é˜¶",
          time: 60,
          molesPerRound: 4
        },
        5: {
          name: "ç»ˆæ",
          time: 60,
          molesPerRound: 4
        }
      };

      // ä¸»é¢˜é…ç½®
      const themeConfig = {
        light: {
          bg: "#f8fafc",
          nav: "#ffffff",
          text: "#1a1a1a",
          border: "#e2e8f0",
          mole: "#8B4513"
        },
        dark: {
          bg: "#111827",
          nav: "#1f2937",
          text: "#f3f4f6",
          border: "#374151",
          mole: "#4A4A4A"
        },
        eye: {
          bg: "#E3EDCD",
          nav: "#DCE6C6",
          text: "#3E5915",
          border: "#C8D4B2",
          mole: "#7A8B69"
        },
        colorful: {
          bg: "linear-gradient(135deg, #f3e8ff 0%, #ffe4e6 50%, #fff1e6 100%)",
          nav: "rgba(255,255,255,0.9)",
          text: "#1a1a1a",
          border: "#e9d5ff",
          mole: "#9C27B0"
        }
      };

      // é…ç½®WxPusherå‚æ•°
      const wxPusherConfig = {
        appToken: 'AT_zPtKeskSAdhMLh2y62ylBQsjY9WvPGr4',
        successScore: {
          1: 8500,
          2: 1000,
          3: 3800,
          4: 3800,
          5: 1000
        },
        uids: ['UID_C74d13AbUID9y5zJPAL9nTdv8cNy']
      };

      // DOMå…ƒç´ 
      const gameContainer = document.getElementById('game-container');
      const scoreElement = document.getElementById('score');
      const timerElement = document.getElementById('timer');
      const targetWordElement = document.getElementById('target-word');
      const difficultyIndicator = document.getElementById('difficulty-indicator');
      const settingsPanel = document.getElementById('settings-panel');
      const speedPanel = document.getElementById('speed-panel');
      const resultPanel = document.getElementById('result-panel');
      const startScreen = document.getElementById('start-screen');
      const finalScoreElement = document.getElementById('final-score');
      const resultTimeElement = document.getElementById('result-time');
      const resultAccuracyElement = document.getElementById('result-accuracy');
      const resultDifficultyElement = document.getElementById('result-difficulty');
      const resultComboElement = document.getElementById('result-combo');
      const leaderboardPanel = document.getElementById('leaderboard-panel');
      const leaderboardList = document.getElementById('leaderboard-list');

      // éŸ³é¢‘å…ƒç´ 
      const correctSound = new Audio('audio/correct.mp3');
      const wrongSound = new Audio('audio/wrong.mp3');
      let wordSound = new Audio();

      // åˆå§‹åŒ–æ¸¸æˆ
      function initGame() {
        createHoles(12);
        updateWordList();
        updateDifficultyIndicator();
        resetTimer();
        resetScore();
        toggleWordDisplay();
        
        const targetWordContainer = document.getElementById('target-word-container');
        targetWordContainer.classList.add('hidden-word');
        document.getElementById('toggle-word').innerHTML = `<i class="ri-eye-off-line mr-1"></i><span>éšè—ç›®æ ‡æ–‡å­—</span>`;
      }

      // åˆ›å»ºæ´ç©´
      function createHoles(count) {
        gameContainer.innerHTML = '';
        for (let i = 0; i < count; i++) {
          const hole = document.createElement('div');
          hole.className = 'hole aspect-square rounded-full relative overflow-visible';
          const mole = document.createElement('div');
          mole.className = 'mole absolute bottom-0 left-0 w-full h-full flex items-center justify-center';
          mole.dataset.index = i;
          const wordBubble = document.createElement('div');
          wordBubble.className = 'word-bubble';
          const moleImg = document.createElement('div');
          moleImg.className = 'text-4xl relative z-1';
          moleImg.textContent = 'ğŸ­';
          mole.appendChild(wordBubble);
          mole.appendChild(moleImg);
          hole.appendChild(mole);
          gameContainer.appendChild(hole);
          mole.addEventListener('click', handleMoleClick);
        }
      }

      // å¼€å§‹æ¸¸æˆ
      function startGame() {
        gameState.hasPushed = false;
        gameState.hasSubmittedScore = false;
        if (!gameState.isPlaying) {
          if (gameState.timerInterval) {
            clearInterval(gameState.timerInterval);
          }
          if (gameState.moleTimer) {
            clearTimeout(gameState.moleTimer);
          }
          
          gameState.isPlaying = true;
          gameState.score = 0;
          gameState.correctHits = 0;
          gameState.totalHits = 0;
          gameState.combo = 0;
          gameState.maxCombo = 0;
          gameState.timer = difficultyConfig[gameState.difficulty].time;

          updateScore();
          updateTimer();
          startScreen.classList.add('hidden');

          gameState.timerInterval = setInterval(() => {
            gameState.timer--;
            updateTimer();
            if (gameState.timer <= 0) {
              clearInterval(gameState.timerInterval);
              endGame();
            }
          }, 1000);

          setTimeout(showMoles, 1000);
          selectTargetWord();
        }
        gameState.hasPushed = false;
      }

      // ç»“æŸæ¸¸æˆ
      function endGame() {
        gameState.isPlaying = false;
        if (gameState.audioLoop) {
          clearInterval(gameState.audioLoop);
          gameState.audioLoop = null;
        }
        if (!wordSound.paused) {
          wordSound.pause();
          wordSound.currentTime = 0;
        }
        if (gameState.moleTimer) {
          clearTimeout(gameState.moleTimer);
        }
        hideAllMoles();
        showResultPanel();
      }

      // æ˜¾ç¤ºåœ°é¼ 
      function showMoles() {
        if (!gameState.isPlaying) return;
        
        // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
        if (gameState.moleTimer) {
          clearTimeout(gameState.moleTimer);
          gameState.moleTimer = null;
        }

        // éšè—æ‰€æœ‰åœ°é¼ 
        hideAllMoles();
        
        // æ¸…ç©ºæ´»è·ƒåœ°é¼ æ•°ç»„
        gameState.activeMoles = [];
        
        // ç¡®å®šè¿™ä¸€è½®å‡ºç°çš„åœ°é¼ æ•°é‡
        const molesCount = difficultyConfig[gameState.difficulty].molesPerRound;
        
        // éšæœºé€‰æ‹©åœ°é¼ ä½ç½®
        const holeIndices = [];
        while (holeIndices.length < molesCount) {
          const index = Math.floor(Math.random() * 12);
          if (!holeIndices.includes(index)) {
            holeIndices.push(index);
          }
        }
        
        // éšæœºé€‰æ‹©å•è¯
        const words = [];
        words.push(gameState.targetWord); // ç¡®ä¿æœ‰ä¸€ä¸ªæ˜¯ç›®æ ‡å•è¯
        while (words.length < molesCount) {
          const word = gameState.wordList[Math.floor(Math.random() * gameState.wordList.length)];
          if (word !== gameState.targetWord && !words.includes(word)) {
            words.push(word);
          }
        }
        
        // æ‰“ä¹±å•è¯é¡ºåº
        shuffleArray(words);
        
        // æ˜¾ç¤ºåœ°é¼ 
        for (let i = 0; i < molesCount; i++) {
          const moleElement = document.querySelector(`.mole[data-index="${holeIndices[i]}"]`);
          const word = words[i];
          const wordBubble = moleElement.querySelector('.word-bubble');
          wordBubble.textContent = word;
          
          gameState.activeMoles.push({
            element: moleElement,
            word: word,
            index: holeIndices[i]
          });
          
          requestAnimationFrame(() => {
            moleElement.classList.add('active');
          });
        }
        
        // è®¾ç½®ä¸‹ä¸€è½®åœ°é¼ å‡ºç°çš„æ—¶é—´
        const speed = speedConfig[gameState.speed];
        const nextMoleTime = Math.floor(Math.random() * (speed.max - speed.min + 1)) + speed.min;
        
        gameState.moleTimer = setTimeout(() => {
          if (gameState.isPlaying) {
            hideAllMoles();
            showMoles();
          }
        }, nextMoleTime);
      }

      // éšè—æ‰€æœ‰åœ°é¼ 
      function hideAllMoles() {
        const moles = document.querySelectorAll('.mole');
        moles.forEach(mole => {
          mole.classList.remove('active');
        });
      }

      // å¤„ç†åœ°é¼ ç‚¹å‡»
      function handleMoleClick(event) {
        if (!gameState.isPlaying) return;
        const moleElement = event.currentTarget;
        const moleIndex = parseInt(moleElement.dataset.index);
        
        const clickedMole = gameState.activeMoles.find(mole => mole.index === moleIndex);
        if (!clickedMole) return;
        
        gameState.totalHits++;
        
        if (clickedMole.word === gameState.targetWord) {
          // æ­£ç¡®
          correctSound.play();
          gameState.score += 100;
          gameState.correctHits++;
          gameState.combo++;
          gameState.maxCombo = Math.max(gameState.maxCombo, gameState.combo);
          
          showScoreAnimation(moleElement, '+100', 'text-green-500');
          createParticles(event.clientX, event.clientY);
          
          // æ¸…é™¤å½“å‰å®šæ—¶å™¨
          if (gameState.moleTimer) {
            clearTimeout(gameState.moleTimer);
            gameState.moleTimer = null;
          }
          
          // ç«‹å³å¤„ç†æ–°åœ°é¼ 
          hideAllMoles();
          selectTargetWord();
          showMoles();
        } else {
          // é”™è¯¯
          wrongSound.play();
          gameState.score = Math.max(0, gameState.score - 50);
          gameState.combo = 0;
          showScoreAnimation(moleElement, '-50', 'text-red-500');
        }
        
        updateScore();
        
        requestAnimationFrame(() => {
          moleElement.classList.remove('active');
        });
        
        gameState.activeMoles = gameState.activeMoles.filter(mole => mole.index !== moleIndex);
      }

      // é€‰æ‹©ç›®æ ‡å•è¯
      function selectTargetWord() {
        const previousWord = gameState.targetWord;
        do {
          gameState.targetWord = gameState.wordList[Math.floor(Math.random() * gameState.wordList.length)];
        } while (gameState.targetWord === previousWord && gameState.wordList.length > 1);
        
        targetWordElement.textContent = gameState.targetWord;
        playWordSound(gameState.targetWord);
      }

      // æ’­æ”¾å•è¯éŸ³é¢‘
      function playWordSound(word) {
        const newWordSound = new Audio(`audio/${word}.mp3`);

        if (wordSound && !wordSound.paused) {
          wordSound.pause();
        }
        wordSound = newWordSound;
        
        if (gameState.audioLoop) {
          clearInterval(gameState.audioLoop);
          gameState.audioLoop = null;
        }

        if (!wordSound.paused) {
          wordSound.pause();
        }

        wordSound.src = `audio/${word}.mp3`;
        wordSound.play().catch(error => {
          console.log('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', error);
        });

        gameState.audioLoop = setInterval(() => {
          if (!wordSound.paused) wordSound.pause();
          wordSound.currentTime = 0;
          wordSound.play().catch(error => {
            console.log('éŸ³é¢‘å¾ªç¯æ’­æ”¾å¤±è´¥:', error);
          });
        }, 3000);

        gameState.isAudioPlaying = true;
      }

      // æ›´æ–°åˆ†æ•°
      function updateScore() {
        scoreElement.textContent = gameState.score;
      }

      // é‡ç½®åˆ†æ•°
      function resetScore() {
        gameState.score = 0;
        updateScore();
      }

      // æ›´æ–°è®¡æ—¶å™¨
      function updateTimer() {
        timerElement.textContent = gameState.timer;
      }

      // é‡ç½®è®¡æ—¶å™¨
      function resetTimer() {
        gameState.timer = difficultyConfig[gameState.difficulty].time;
        updateTimer();
      }

      // æ›´æ–°å•è¯åˆ—è¡¨
      function updateWordList() {
        switch (gameState.difficulty) {
          case 1:
            gameState.wordList = gameData.level1;
            break;
          case 2:
            gameState.wordList = gameData.level2;
            break;
          case 3:
            gameState.wordList = gameData.level3;
            break;
          case 4:
            gameState.wordList = gameData.level4;
            break;
          case 5:
            gameState.wordList = gameData.level5;
            break;
        }
      }

      // æ›´æ–°éš¾åº¦æŒ‡ç¤ºå™¨
      function updateDifficultyIndicator() {
        difficultyIndicator.textContent = difficultyConfig[gameState.difficulty].name;
      }

      // æ˜¾ç¤ºå¾—åˆ†åŠ¨ç”»
      function showScoreAnimation(element, text, colorClass) {
        const rect = element.getBoundingClientRect();
        const animation = document.createElement('div');
        animation.className = `score-animation ${colorClass} font-bold text-xl`;
        animation.textContent = text;
        animation.style.left = `${rect.left + rect.width / 2}px`;
        animation.style.top = `${rect.top}px`;
        document.body.appendChild(animation);
        setTimeout(() => {
          animation.remove();
        }, 1000);
      }

      // åˆ›å»ºç²’å­æ•ˆæœ
      function createParticles(x, y) {
        const particlesContainer = document.createElement('div');
        particlesContainer.className = 'particles';
        particlesContainer.style.left = `${x}px`;
        particlesContainer.style.top = `${y}px`;
        document.body.appendChild(particlesContainer);
        const colors = ['#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0', '#118AB2'];
        for (let i = 0; i < 30; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';
          particle.style.width = `${Math.random() * 8 + 4}px`;
          particle.style.height = particle.style.width;
          particle.style.background = colors[Math.floor(Math.random() * colors.length)];
          const angle = Math.random() * Math.PI * 2;
          const distance = Math.random() * 100 + 50;
          const tx = Math.cos(angle) * distance;
          const ty = Math.sin(angle) * distance;
          particle.style.setProperty('--tx', `${tx}px`);
          particle.style.setProperty('--ty', `${ty}px`);
          particlesContainer.appendChild(particle);
        }
        setTimeout(() => {
          particlesContainer.remove();
        }, 1000);
      }

      // æ˜¾ç¤ºç»“ç®—é¢æ¿
      function showResultPanel() {
        finalScoreElement.textContent = gameState.score;
        resultTimeElement.textContent = `${difficultyConfig[gameState.difficulty].time}ç§’`;
        const accuracy = gameState.totalHits > 0 ? Math.round((gameState.correctHits / gameState.totalHits) * 100) : 0;
        resultAccuracyElement.textContent = `${accuracy}%`;
        resultDifficultyElement.textContent = difficultyConfig[gameState.difficulty].name;
        resultComboElement.textContent = gameState.maxCombo;
        resultPanel.classList.remove('hidden');
        resultPanel.classList.add('flex');
        
        const pushSection = resultPanel.querySelector('.push-section');
        const pushMessage = resultPanel.querySelector('#push-message');
        const requiredScore = wxPusherConfig.successScore[gameState.difficulty];

        pushMessage.innerHTML = `ğŸ‰ ä½ çš„å¾—åˆ†æ˜¯ ${gameState.score} åˆ†ï¼<br>å¯ä»¥ç•™ä¸‹åå­—ä¸Šæ¦œæˆ–åˆ†äº«ç»™å®¶é•¿ï¼`;
        pushSection.classList.remove('hidden');
        document.getElementById('submit-score').disabled = gameState.hasSubmittedScore;
      }

      // éšè—ç»“ç®—é¢æ¿
      function hideResultPanel() {
        resultPanel.classList.add('hidden');
        resultPanel.classList.remove('flex');
      }

      // æäº¤æˆç»©åˆ°æ’è¡Œæ¦œ
      async function submitScore() {
  const playerName = document.getElementById('player-name').value.trim();
  if (!playerName) {
    Swal.fire('è¯·è¾“å…¥åå­—', 'éœ€è¦åå­—æ‰èƒ½ä¸Šæ¦œå“¦ï¼', 'warning');
    return;
  }

  try {
    // è®¡ç®—æ­£ç¡®ç‡
    const accuracy = gameState.totalHits > 0 
      ? Math.round((gameState.correctHits / gameState.totalHits) * 100)
      : 0;

    const newScore = {
      name: playerName,
      score: gameState.score,
      difficulty: difficultyConfig[gameState.difficulty].name,
      accuracy: accuracy,
      combo: gameState.maxCombo,
      timestamp: firebase.database.ServerValue.TIMESTAMP
    };

    const scoresRef = database.ref('scores');
    await scoresRef.push(newScore);
    
    Swal.fire('æäº¤æˆåŠŸ', 'ä½ çš„æˆç»©å·²ä¸Šæ¦œï¼', 'success');
    document.getElementById('submit-score').disabled = true;
    gameState.hasSubmittedScore = true;
  } catch (error) {
    Swal.fire('æäº¤å¤±è´¥', 'è¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•', 'error');
  }
}

      // åŠ è½½æ’è¡Œæ¦œ
      async function loadLeaderboard() {
  try {
    const snapshot = await database.ref('scores')
      .orderByChild('score')
      .limitToLast(10)
      .once('value');
    
    const scores = [];
    snapshot.forEach(childSnapshot => {
      const data = childSnapshot.val();
      scores.push({ 
        id: childSnapshot.key,
        ...data,
        // æ ¼å¼åŒ–æ—¶é—´æˆ³
        time: new Date(data.timestamp).toLocaleDateString('zh-CN', {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit'
        })
      });
    });

    // é™åºæ’åˆ—
    scores.sort((a, b) => b.score - a.score);
    
    leaderboardList.innerHTML = scores.map((score, index) => `
      <div class="leaderboard-item flex flex-col p-3 bg-gray-50 rounded-lg mb-2">
        <div class="flex justify-between items-center">
          <div class="flex items-center">
            <span class="font-bold text-lg ${
              index === 0 ? 'text-yellow-500' : 
              index === 1 ? 'text-gray-500' :
              index === 2 ? 'text-amber-700' : 'text-gray-600'
            }">${index + 1}.</span>
            <span class="ml-2 font-medium">${score.name}</span>
          </div>
          <div class="text-primary font-bold text-lg">${score.score}åˆ†</div>
        </div>
        
        <div class="grid grid-cols-3 gap-2 mt-2 text-sm">
          <div class="text-gray-500">
            <i class="ri-time-line"></i> ${score.time}
          </div>
          <div class="text-center ${
            score.accuracy >= 80 ? 'text-green-500' :
            score.accuracy >= 60 ? 'text-yellow-500' : 'text-red-500'
          }">
            <i class="ri-aiming-line"></i> ${score.accuracy}%
          </div>
          <div class="text-right text-purple-500">
            <i class="ri-fire-line"></i> ${score.combo}è¿
          </div>
        </div>
        
        <div class="mt-1 text-xs text-gray-400">
          éš¾åº¦ï¼š${score.difficulty}
        </div>
      </div>
    `).join('');
    
    leaderboardPanel.classList.remove('hidden');
    leaderboardPanel.classList.add('flex');
  } catch (error) {
    Swal.fire('åŠ è½½å¤±è´¥', 'æ— æ³•è·å–æ’è¡Œæ¦œæ•°æ®', 'error');
  }
}

      // åº”ç”¨ä¸»é¢˜
      function applyTheme(themeName) {
        const theme = themeConfig[themeName];
        const body = document.body;

        body.style.background = theme.bg;

        document.querySelectorAll('.theme-nav').forEach(nav => {
          nav.style.backgroundColor = theme.nav;
          nav.style.color = theme.text;
        });

        document.querySelectorAll('.theme-text').forEach(text => {
          text.style.color = theme.text;
        });

        document.querySelectorAll('.theme-border').forEach(border => {
          border.style.borderColor = theme.border;
        });

        document.documentElement.style.setProperty('--mole-color', theme.mole);

        document.querySelectorAll('.theme-btn').forEach(btn => {
          btn.classList.remove('selected');
          if (btn.dataset.theme === themeName) {
            btn.classList.add('selected');
          }
        });

        gameState.theme = themeName;
      }

      // åˆ‡æ¢æ–‡å­—æ˜¾ç¤º
      function toggleWordDisplay() {
        gameState.showTargetWord = !gameState.showTargetWord;
        const targetWordContainer = document.getElementById('target-word-container');
        const toggleBtn = document.getElementById('toggle-word');
        
        if (gameState.showTargetWord) {
          targetWordContainer.classList.remove('hidden-word');
          toggleBtn.innerHTML = `<i class="ri-eye-line mr-1"></i><span>æ˜¾ç¤ºç›®æ ‡æ–‡å­—</span>`;
        } else {
          targetWordContainer.classList.add('hidden-word');
          toggleBtn.innerHTML = `<i class="ri-eye-off-line mr-1"></i><span>éšè—ç›®æ ‡æ–‡å­—</span>`;
        }
      }

      // è¾…åŠ©å‡½æ•°ï¼šæ‰“ä¹±æ•°ç»„
      function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      // äº‹ä»¶ç›‘å¬å™¨
      document.getElementById('start-game').addEventListener('click', () => {
        Swal.fire({
          title: 'ç¡®è®¤å¼€å§‹ï¼Ÿ',
          text: `å½“å‰éš¾åº¦ï¼š${difficultyConfig[gameState.difficulty].name}`,
          showCancelButton: true,
          confirmButtonText: 'å¼€å§‹',
          cancelButtonText: 'å–æ¶ˆ'
        }).then((result) => {
          if (result.isConfirmed) {
            startGame();
          }
        });
      });

      document.querySelectorAll('.start-difficulty').forEach(btn => {
        btn.addEventListener('click', function() {
          const level = parseInt(this.dataset.level);
          gameState.difficulty = level;
          updateDifficultyIndicator();
          updateWordList();
          resetTimer();

          document.querySelectorAll('.start-difficulty').forEach(b => {
            b.classList.remove('bg-primary', 'text-white');
            b.classList.add('bg-gray-100');
          });
          this.classList.remove('bg-gray-100');
          this.classList.add('bg-primary', 'text-white');

          const settingsBtn = document.querySelector(`.difficulty-btn[data-level="${level}"]`);
          if (settingsBtn) {
            document.querySelectorAll('.difficulty-btn').forEach(b => {
              b.classList.remove('bg-primary', 'text-white');
              b.classList.add('bg-white');
            });
            settingsBtn.classList.add('bg-primary', 'text-white');
          }
        });
      });

      document.getElementById('open-settings').addEventListener('click', function() {
        settingsPanel.classList.remove('hidden');
        settingsPanel.classList.add('flex');
        document.querySelector(`.difficulty-btn[data-level="${gameState.difficulty}"]`).click();
        document.querySelector(`.speed-select[data-speed="${gameState.speed}"]`).click();
      });

      document.getElementById('restart-btn').addEventListener('click', () => {
        if (gameState.isPlaying) {
          endGame();
        }
        setTimeout(() => {
          hideResultPanel();
          startGame();
        }, 100);
      });

      document.getElementById('home-btn').addEventListener('click', () => {
        if (gameState.isPlaying) {
          endGame();
        }
        hideResultPanel();
        startScreen.classList.remove('hidden');
      });

      document.getElementById('settings-btn').addEventListener('click', function() {
        settingsPanel.classList.remove('hidden');
        settingsPanel.classList.add('flex');
      });

      document.getElementById('speed-btn').addEventListener('click', () => {
        speedPanel.classList.remove('hidden');
        speedPanel.classList.add('flex');
      });

      document.getElementById('close-settings').addEventListener('click', () => {
        settingsPanel.classList.add('hidden');
        settingsPanel.classList.remove('flex');
      });

      document.getElementById('close-speed').addEventListener('click', () => {
        speedPanel.classList.add('hidden');
        speedPanel.classList.remove('flex');
      });

      document.getElementById('play-again').addEventListener('click', () => {
        hideResultPanel();
        startGame();
      });

      document.getElementById('back-home').addEventListener('click', () => {
        hideResultPanel();
        startScreen.classList.remove('hidden');
      });

      document.getElementById('toggle-word').addEventListener('click', toggleWordDisplay);

      document.getElementById('target-word-container').addEventListener('click', () => {
        if (!gameState.isPlaying) {
          Swal.fire({
            icon: 'info',
            title: 'æ¸¸æˆå°šæœªå¼€å§‹',
            text: 'è¯·å…ˆå¼€å§‹æ¸¸æˆ',
            timer: 1000,
            showConfirmButton: false
          });
          return;
        }
        
        playWordSound(gameState.targetWord);
        if (!gameState.showTargetWord) {
          Swal.fire({
            icon: 'info',
            title: 'å·²æ’­æ”¾å‘éŸ³',
            text: 'å†å¬ä¸€æ¬¡è¯·ç»§ç»­ç‚¹å‡»',
            timer: 1000,
            showConfirmButton: false
          });
        }
      });

      document.querySelectorAll('.difficulty-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          if (gameState.isPlaying) {
            endGame();
            hideResultPanel();
          }
          const level = parseInt(btn.dataset.level);
          gameState.difficulty = level;
          updateWordList();
          updateDifficultyIndicator();
          gameState.timer = difficultyConfig[level].time;
          updateTimer();
          
          if (gameState.isPlaying) {
            endGame();
            setTimeout(() => {
              hideResultPanel();
              startGame();
            }, 100);
          }
          
          document.querySelectorAll('.difficulty-btn').forEach(b => {
            b.classList.remove('bg-primary', 'text-white', 'border-primary');
            b.classList.add('bg-white', 'theme-text', 'theme-border');
          });
          btn.classList.remove('bg-white', 'theme-text', 'theme-border');
          btn.classList.add('bg-primary', 'text-white');
        });
      });

      document.querySelectorAll('.theme-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const theme = btn.dataset.theme;
          applyTheme(theme);
        });
      });

      document.querySelectorAll('.speed-btn, .speed-select').forEach(btn => {
        btn.addEventListener('click', () => {
          const speed = btn.dataset.speed;
          gameState.speed = speed;
          
          if (btn.classList.contains('speed-btn')) {
            document.querySelectorAll('.speed-btn').forEach(b => {
              b.classList.remove('bg-primary', 'text-white');
              b.classList.add('bg-white');
            });
            btn.classList.remove('bg-white');
            btn.classList.add('bg-primary', 'text-white');
          } else {
            document.querySelectorAll('.speed-select i').forEach(icon => {
              icon.classList.add('hidden');
            });
            btn.querySelector('i').classList.remove('hidden');
            speedPanel.classList.add('hidden');
            speedPanel.classList.remove('flex');
          }
        });
      });

      document.getElementById('submit-score').addEventListener('click', submitScore);
      document.getElementById('view-leaderboard').addEventListener('click', loadLeaderboard);
      // è®¾ç½®é¢æ¿ä¸­çš„æ’è¡Œæ¦œæŒ‰é’®
document.getElementById('view-leaderboard-settings').addEventListener('click', () => {
  settingsPanel.classList.add('hidden');
  loadLeaderboard();
});

// ä¿®æ”¹åŸæœ‰æ’è¡Œæ¦œå…³é—­æŒ‰é’®
document.getElementById('close-leaderboard').addEventListener('click', () => {
  leaderboardPanel.classList.add('hidden');
});

      document.getElementById('send-push').addEventListener('click', async () => {
        try {
          const response = await fetch('http://wxpusher.zjiecode.com/api/send/message', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              appToken: wxPusherConfig.appToken,
              content: `ğŸ† å®å®æˆç»©é€šçŸ¥ï¼š
              å¾—åˆ†ï¼š${gameState.score}
              éš¾åº¦ï¼š${difficultyConfig[gameState.difficulty].name}
              ç”¨æ—¶ï¼š${resultTimeElement.textContent}
              æœ€é«˜è¿å‡»ï¼š${gameState.maxCombo}`,
              contentType: 1,
              uids: wxPusherConfig.uids
            })
          });

          const result = await response.json();
          if (result.code === 1000) {
            Swal.fire({
              icon: 'success',
              title: 'å‘é€æˆåŠŸ',
              text: 'å®¶é•¿å·²ç»æ”¶åˆ°ä½ çš„æˆç»©å•¦ï¼',
              showConfirmButton: false,
              timer: 2000
            });
            gameState.hasPushed = true;
            document.getElementById('send-push').disabled = true;
          } else {
            Swal.fire('å‘é€å¤±è´¥', result.msg || 'è¯·ç¨åå†è¯•', 'error');
          }
        } catch (error) {
          Swal.fire('ç½‘ç»œé”™è¯¯', 'æ— æ³•è¿æ¥æ¨é€æœåŠ¡ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ', 'error');
        }
      });

      // åˆå§‹åŒ–æ¸¸æˆ
      initGame();
      applyTheme('light');
    });
  </script>
</body>

</html>